var B=Object.defineProperty;var P=(s,t,e)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var p=(s,t,e)=>(P(s,typeof t!="symbol"?t+"":t,e),e);import{d as O,c as h,a as c,t as f,b as j,F as v,r as J,p as T,e as q,o as d,w as V,v as X,f as _,g as W,h as D,i as H}from"./vendor.d7be0d24.js";const z=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}};z();const Z="modulepreload",L={},G="/",x=function(t,e){return!e||e.length===0?t():Promise.all(e.map(i=>{if(i=`${G}${i}`,i in L)return;L[i]=!0;const o=i.endsWith(".css"),r=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${r}`))return;const n=document.createElement("link");if(n.rel=o?"stylesheet":Z,o||(n.as="script",n.crossOrigin=""),n.href=i,document.head.appendChild(n),o)return new Promise((u,K)=>{n.addEventListener("load",u),n.addEventListener("error",K)})})).then(()=>t())},E={ball:{type:"ball",name:"\u5C0F\u7403",config:["radius:m","x:m","y:m","mass:kg","vx:m/s","vy:m/s"]}},M={},m={},I={G:667259e-16,c:299792458,k:8987551787368176e-6,e:1602176634e-28};function Y(s){M[s.id]=s}function g(){return M}function $(s){m[s.id]=s}function Q(s){return m[s]===void 0?!1:(delete m[s],!0)}function b(){return m}class A{constructor(t,e,i){this.name=t,this.type=e,this.magnitude=i,this.id=A.idCounter++,$(this)}destroy(){Q(this.id)}}A.idCounter=0;class tt extends A{constructor(t,e,i){super(t,e,i)}}class S extends A{constructor(t,e,i){super(t,e,i)}}class N extends S{constructor(t,e){super(t,"gravity");this.centralObject=e,this.mass=e.mass,this.center=e.position}calculateForceGravity(t){if(t===this.centralObject)return[0,0];const e=[0,0],i=t.position[0]-this.center[0],o=t.position[1]-this.center[1],r=Math.sqrt(Math.pow(i,2)+Math.pow(o,2));return e[0]=-(this.mass*t.mass*I.G)/Math.pow(r,2)*i/r,e[1]=-(this.mass*t.mass*I.G)/Math.pow(r,2)*o/r,e}}class et{constructor(){this.objectList={},this.fieldList={},this.objectList=g(),this.fieldList=b()}analyzeAll(t){const e=Object.values(this.objectList);for(const i of e)i.calculateAcceleration(t)}}class st{constructor(t){this.loopFuncs=[],this.status="running",this.speed=1,this.config=t,this.run(),this.analyzer=new et}run(){this.createLoop(),this.status="running"}stop(){this.status="stopped"}pause(){this.status="paused"}resume(){this.status="running"}createLoop(){let t=0,e=0,i=this;this.loop=o=>{if(i.status==="paused")return requestAnimationFrame(this.loop);if(i.status==="running"){let r=o-e;e=o,t++;for(let n=0;n<this.config.refreshRate;n++)i.update();for(let n of i.loopFuncs)n(t,r);requestAnimationFrame(this.loop)}else if(i.status==="stopped"){this.loop=void 0;return}},requestAnimationFrame(this.loop)}update(){this.analyzer.analyzeAll(this.config.refreshRate),this.moveAllObjects()}addLoop(t){this.loopFuncs.push(t)}removeLoop(t){this.loopFuncs.splice(this.loopFuncs.indexOf(t),1)}moveAllObjects(){const t=Object.values(g());for(const e of t)e.move(this.config.refreshRate*this.speed)}setSpeed(t){this.speed=t}}class w extends tt{constructor(t,e,i){super(t,"electric",e);this.setShape(i)}isInField(t){return this.shape.isInShape(t.position)}calculateForceElectic(t){if(!this.isInField(t))return[0,0];const e=[0,0],i=this.magnitude[0]*t.charge,o=this.magnitude[1]*t.charge;return e[0]=i,e[1]=o,e}setShape(t){this.shape=t}}class y{constructor(t,e){this.mass=0,this.velocity=[0,0],this.acceleration=[0,0],this.forces=[],this.position=[0,0],this.charge=0,this.name=t,this.id=y.idCounter++,this.gravityField=new N(this.name,this),Y(this),this.setConfig(e)}setConfig(t){t.description&&(this.description=t.description),t.mass&&this.setMass(t.mass),t.position&&this.setPosition(t.position[0],t.position[1]),t.velocity&&this.setVelocity(t.velocity[0],t.velocity[1]),t.charge&&this.setCharge(t.charge),t.shape&&this.setShape(t.shape)}setPosition(t=this.position[0],e=this.position[1]){this.position[0]=t,this.position[1]=e}setShape(t){this.shape=t}setMass(t){this.mass=t,this.gravityField.mass=t}addForce(t){this.forces.push(t)}removeForce(t){this.forces.splice(this.forces.indexOf(t),1)}addAcceleration(t,e){this.acceleration[0]+=t,this.acceleration[1]+=e}isInField(t){if(t instanceof S)return!0}move(t=1){this.position[0]+=this.velocity[0]/t,this.position[1]+=this.velocity[1]/t}setVelocity(t,e){this.velocity[0]=t,this.velocity[1]=e}setCharge(t){this.charge=t}calculateForce(){const t=[0,0],e=Object.values(b());for(const i of e)if(i instanceof N){const o=i.calculateForceGravity(this);t[0]+=o[0],t[1]+=o[1]}else if(i instanceof w){const o=i.calculateForceElectic(this);t[0]+=o[0],t[1]+=o[1]}return t}calculateAcceleration(t=1){if(!this.mass)return;const e=this.calculateForce(),i=[0,0];return i[0]=e[0]/this.mass,i[1]=e[1]/this.mass,this.acceleration=i,this.velocity[0]+=i[0]/t,this.velocity[1]+=i[1]/t,i}}y.idCounter=0;class C extends y{constructor(t,e){super(t,e);this.radius=e.radius}}class it{constructor(t,e,i,o){this.id=t,this.type=e,this.center=i,this.setNode(o)}setNode(t){this.node=t,this.node.push(t[0])}setRadius(t){this.radius=t}isInShape(t){if(this.type==="circle")return Math.pow(t[0]-this.center[0],2)+Math.pow(t[1]-this.center[1],2)<=Math.pow(this.radius,2);if(this.type==="polygon"){let e=0;for(let i=0;i<this.node.length-1;i++){const o=this.node[i][1],r=this.node[i+1][1];t[1]>=Math.min(o,r)&&t[1]<=Math.max(o,r)&&t[0]<=Math.max(this.node[i][0],this.node[i+1][0])&&e++}return e%2==1}}}const ot=new st({refreshRate:10});x(()=>Promise.resolve().then(function(){return at}),void 0).then(s=>window.cnb=s);const a=class{constructor(){this.init(),a.div=document.getElementById("app"),this.initDraw()}init(){["objects","fields"].forEach(t=>{const e=document.getElementById(t);a.canvases[t]=e,a.contexts[t]=e.getContext("2d")})}initDraw(){ot.addLoop(this.drawAllObjects),this.resize(),window.addEventListener("resize",this.resize)}resize(){const t=Object.values(a.canvases);for(const e of t)e.setAttribute("width",`${window.innerWidth}px`),e.setAttribute("height",`${window.innerHeight}px`),e.style.width=`${window.innerWidth}px`,e.style.height=`${window.innerHeight}px`;a.div.setAttribute("width",`${window.innerWidth}px`),a.div.setAttribute("height",`${window.innerHeight}px`),a.div.style.width=`${window.innerWidth}px`,a.div.style.height=`${window.innerHeight}px`}drawAllObjects(){const t=a.contexts.objects;if(!(t instanceof CanvasRenderingContext2D))return;const e=Object.values(a.objectList);t.clearRect(0,0,parseFloat(a.canvases.objects.style.width||"0"),parseFloat(a.canvases.objects.style.height||"0"));for(const i of e)if(i instanceof C){const[o,r]=i.position,n=t.createRadialGradient(o,r,0,o,r,i.radius);n.addColorStop(0,"white"),n.addColorStop(1,"green"),t.fillStyle=n,t.beginPath(),t.arc(i.position[0],i.position[1],i.radius,0,Math.PI*2),t.fill()}}};let l=a;p(l,"canvases",{}),p(l,"contexts",{}),p(l,"div"),p(l,"objectList",g()),p(l,"fieldList",b());function R(){const s=l.contexts.fields;if(!(s instanceof CanvasRenderingContext2D))return;const t=Object.values(l.fieldList);s.clearRect(0,0,parseFloat(l.canvases.fields.style.width||"0"),parseFloat(l.canvases.fields.style.height||"0"));for(const e of t)if(e.type==="electric"&&e instanceof w){if(e.shape.type==="circle"){const[i,o]=e.shape.center;s.fillStyle="rgba(0, 0, 255, 0.5)",s.beginPath(),s.arc(i,o,e.shape.radius,0,Math.PI*2),s.fill()}else if(e.shape.type==="polygon"){s.fillStyle="rgba(0, 0, 255, 0.5)",s.beginPath(),s.moveTo(e.shape.node[0][0],e.shape.node[0][1]);for(const[i,o]of e.shape.node)s.lineTo(i,o);s.closePath(),s.fill()}}}var nt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Draw:l,drawAllFields:R});function k(s){return new C("ball",s.config)}function rt(s,t,e){const i=new w(s,t,e);return R(),i}function U(s){return{mass:"\u8D28\u91CF",radius:"\u534A\u5F84",x:"x\u5750\u6807",y:"y\u5750\u6807",vx:"x\u901F\u5EA6",vy:"y\u901F\u5EA6"}[s]||s}var at=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addRoundObject:k,addUniformElectricField:rt,getName:U,Shape:it}),ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAtBQTFRFAAAADSwTCUkWBWAYAIQdAIUdAIUeCE4WAXscAIcfAIghAIojAIskAIslAIwlAIkiB1QXAIokAIwmAI4oAJAqAJAsAJEtAJIuAJEsAI8qAI4pCj0VAIkhAJMvAJUyAJY0AJc2AJg3AJg4AJk4AJc3B1MWAIYfAI0nAJMwAJo7AJw+AJ1AAJ5CAJ1BAJY1BWIZAIcgAJo6AJ9DAKFGAKNKAKRMAKVOAKVNAKJJAKFHAJ9CAJw/AJk6AJc1AIggBWEYAJQyAJs9AKRNAKZRAKhUAqpXDqtZFKtaEqpZAKdRAJw9AI0mAJYzAJ5BAKhTBqtYHq1dKK9gMLBjM7JlNbJmNLFlL7FjAKFIAJUzAKZQLbBiOLJnQbRrRrZuSbdwS7dxSrhxP7RqAKlWAJArAKdSK69hObNoRLZtTLhyU7t3V716XL58Xr59Xb99Wb17TblzF6xbVbt4ZcGCacKFbcSIbsSJcMSKasOGZcCCPbRqAIYeQLVrT7l0W717dceOesmRfcuUgMuWfsqUEqxaAJk5Xb18Z8KEcsaMe8mSg8yYic2djc+gj9Ciic+dIq1dktGkmNSpnNasn9eumdSpAJIvC6pYRLVtf8uVi8+fldOnptm0q9y4rd26ptq0n9aujM6fAI8pAJs8fMqTl9OoodiwrNy5tODAuuLFvePHvuTIis6eJ65fUrp2dMaNkNGjq9u4t+DCwOTJx+jPy+nSzOnTx+fPwOXJtuDBntatdcaOY8CBAKRLRbdus9+/zOrT1e7b2fDf2/DgMbFkndWsueLE1e3b4fHl5/Xr6PXsb8WKr9279fv2AKROf8qV2u/f9fr2AJItSLhwjtChyOjQ4PLljs+hAKNLWLx6esiRmNOoBWEZAJ0/AKlVhM2Zt+HCweXKkdKkAKlUAJQxAKBGHKxcbcOIoNevueHEotewltKnVbx4N7NnAJ9EPrVrVLp3IK5en7V2pQAAAPB0Uk5TALD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Sg624gAABVZJREFUeJx1lflbUnkUxlHpJpcLBoheMkQwURFJGYOLYhF6oTINHC3FNExCTNREyXIdzXEnlTQr1EnLtBxr2pyaUsuy1DZbJqsZm0ltlmb7F+Zqy9N6fn6f73nOec/7+eJw75WdvQN+AQDg8Q72drjP10JHAkiESCQyBDmBBMeFn5EtAkAKleZMd3FxdYEZi6kUEFj0CZkbsASiwUx3lgeb48leynJnwjQyCLh9qPPiEr3pPiyOL8+Pj5U/z5cj8IG9idwPHl0WQGYwBYE84RdBy0UikXg5IgkOkYYynckrVr6rWwlS6TLOKiEiDwtHFQrlajR8jRwRrmXL6NSAd5SLVkTA6wIjJaKo9Sp19JcxMbEb1Kr1UeKNkYFxMHXF2+5uXBI9TspH4lGVJmFTYtJmbVJicoJGtSUe4UvjUkjcNxMBFIa7lB+kU27VpxrStqUbM9Iz07JS9WqlLogfKHMmAq8bg95Mth+i265J1mYbTTm55h25eTuN2dpdGqUO8WczvUGveWE+BAt4kjXKDQWFRSZzcclXpaVlJcVmU1FhQfTusI28UJicP+8b6O1TLpSj6uSsrysqq6prauvqai3VVZUVRVm71FvkQqkPDZxz0xGih/KQqD16Q1FOcamlvqHRam3cW28pLa4o0ur3RCEhAhhyxO6FS23i8OXNmn3ZOytb9h+wHrS1ttra2g9801Jpyk7VNMuDOU1Urh3OHjzk3iHRqfRZGeZOy+EjXUe7e451H7UdOXy802zM0qt0kg73xUvscQ5OznE8JLx307emvuoT7Se/O3X6zNlz/d/bztdXX/ghLbk3HOGxGE4OODwEe0ReRDWXtuWVWBraBvoHhy5fGRrsP9q211KSl5kYjS7394AhPA6AXJby5YrhpKLcstqrtmunR67fGL0+cu6arbG2LDc9aXi1nM92wYT5ZFeOULQ7xmAcKz1hHe8ZvDJ68+bolcFj49a60rEMbYxSFOzpSgZwAMmVzb+ljNUad9yuO9/ac/bO6N27Ny6f6Wltr2sxGzfHKkTYiyRMCE2w+WJF7L10c9n9xq7uB0MPR0cfDp3utjX+ONd6XjiBCfEU2MP/EapJnMx7bHmCDXN25M7lkcFTAwcbakpyJhM16EU/DzoFj3tKTGH9hPysLkgzFU/VW23P+h8MDj745VmX9depYlNagfp5UAgrheiALZw27TsTNptgML6oqjnwm23gWk/P7wMn//jTUpVrNCTMhs34ymigPc6OEMEsDxY3R6e+NPXNWdjWNT5ua7Me3l86b+F6sdCTGUHAcOBIoQt4iE6VoM2s6GupqX/S2N5+taHe0lJckan9S6XDjKFTHOfObAltOvBvMbr1n8L0nL7OKcv9uhP3j0919uWkFyZvRUXCwOlXZ4YtCGatlcQrNMlZmaYXFx6X3W4pK+nL3ZmZtUmjjJesEtAh4HUUaExP/6D5KLw0mvLMY2O5eaaMbENy9HYdEslh0sDXOcQTGTIshDqFOgEL12S60Vg0+a9h36twSWWMN+HCuRHIcJwvPygM3bNBX3BJqzXcu1Sgj/4PXYME+66DqYS3APIKoNLjyv0lcl3zbK9mODZ2WNM7i+rkEj8pBoAAr/eQAss4PCEi1j1HFUqlAg3XiREhj+NOp4LL3oNPAInBZEl5/BnkkfyWSH4RmeHzygVMBingPUhhoxOINHhaUN4REhkcLORHhnR4hk7DNIjwEUvd8CBES2maxkDKZi/1iJM10b0hcMFHIMXNoxmKWJwCT7i6TsAphyIgMP9TaJ6HhiMXdKJgtIcoTiD3s7CfKzv7p3gAyAcWPP3w+/gfUNDCpWCG/aUAAAAASUVORK5CYII=";var F=(s,t)=>{const e=s.__vccOpts||s;for(const[i,o]of t)e[i]=o;return e};const lt={x:"0",y:"0",vx:"0",vy:"0",mass:"1",radius:"50"},dt=O({name:"ObjectsVue",props:{_name:{type:String,required:!0},_type:{type:String,required:!0}},data(){return{detail:!1,obj:E,getName:U,configs:lt}},methods:{createConfig(s){const t={};for(const e in s){const i=parseFloat(s[e]);isNaN(i)?t[e]=s[e]:t[e]=i}return t.position=[t.x,t.y],t.velocity=[t.vx,t.vy],{type:this._type,config:t}},create(s){const t=this.createConfig(s);return console.log(t),k(t)},triggerDetail(){this.detail=!this.detail}}}),ht=s=>(T("data-v-a5a4f25c"),s=s(),q(),s),ut={class:"object"},pt={id:"brief"},At=ht(()=>c("img",{id:"image",src:ct},null,-1)),ft={class:"text"},mt={key:0},yt={class:"detail"},vt={class:"input-prompt"},gt={id:"input-box"},bt=["onUpdate:modelValue"],wt={id:"unit"};function Ft(s,t,e,i,o,r){return d(),h("div",ut,[c("div",pt,[c("button",{id:"detail",onClick:t[0]||(t[0]=n=>s.triggerDetail())},f(s.detail?"\u7B80\u7565":"\u8BE6\u7EC6"),1),At,c("span",ft,f(s._name),1),c("button",{class:"create",onClick:t[1]||(t[1]=n=>s.create(s.configs))},"\u521B\u5EFA")]),s.detail?(d(),h("hr",mt)):j("",!0),s.detail?(d(!0),h(v,{key:1},J((s.obj[s._type]||{}).config,n=>(d(),h("div",yt,[c("span",vt,f(s.getName(n.split(":")[0])),1),c("span",gt,[V(c("input",{class:"input",type:"text","onUpdate:modelValue":u=>s.configs[n.split(":")[0]]=u},null,8,bt),[[X,s.configs[n.split(":")[0]],void 0,{trim:!0}]]),c("span",wt,f(n.split(":")[1]),1)])]))),256)):j("",!0)])}var Ot=F(dt,[["render",Ft],["__scopeId","data-v-a5a4f25c"]]);const jt=Object.values(E),Jt=O({name:"RightBar",setup:()=>({list:jt}),methods:{},components:{ObjectsVue:Ot}}),_t={id:"right-bar"};function Lt(s,t,e,i,o,r){const n=_("ObjectsVue");return d(),h("div",_t,[(d(!0),h(v,null,J(s.list,u=>(d(),W(n,{_name:u.name,_type:u.type},null,8,["_name","_type"]))),256))])}var xt=F(Jt,[["render",Lt],["__scopeId","data-v-7925ba1a"]]);const Et={name:"App",data(){return{rightToolbar:!0}},components:{RightBar:xt}},Mt=c("canvas",{id:"objects"},null,-1),It=c("canvas",{id:"fields"},null,-1);function St(s,t,e,i,o,r){const n=_("RightBar");return d(),h(v,null,[Mt,It,D(n)],64)}var Nt=F(Et,[["render",St]]);H(Nt).mount("#app");x(()=>Promise.resolve().then(function(){return nt}),void 0).then(s=>new s.Draw);
