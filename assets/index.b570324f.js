var ke=Object.defineProperty;var je=(t,e,s)=>e in t?ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var k=(t,e,s)=>(je(t,typeof e!="symbol"?e+"":e,s),s);import{d as E,c as m,a as l,t as F,b as j,F as S,r as B,o as g,w as ce,v as le,p as I,e as M,f as L,g as G,h as Ie,i as T,j as Me,K as Be,k as Le}from"./vendor.76bb25af.js";const Oe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}};Oe();const Ne="modulepreload",de={},Pe="/",ue=function(e,s){return!s||s.length===0?e():Promise.all(s.map(n=>{if(n=`${Pe}${n}`,n in de)return;de[n]=!0;const i=n.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${a}`))return;const o=document.createElement("link");if(o.rel=i?"stylesheet":Ne,i||(o.as="script",o.crossOrigin=""),o.href=n,document.head.appendChild(o),i)return new Promise((c,r)=>{o.addEventListener("load",c),o.addEventListener("error",r)})})).then(()=>e())},X={ball:{type:"ball",name:"\u5C0F\u7403",img:"ball.png",config:["radius:m","x:m","y:m","mass:kg","vx:m/s","vy:m/s","charge:C"]},electricField:{type:"electricField",name:"\u7535\u573A",img:"electricField.png",config:["x:m","y:m","scale:","electricMagnitudeX:N/C","electricMagnitudeY:N/C","shape:choose"]}},he={},R={},pe={G:667259e-16,c:299792458,k:8987551787368176e-6,e:1602176634e-28};function Te(t){he[t.id]=t}function J(){return he}function Re(t){R[t.id]=t}function De(t){return R[t]===void 0?!1:(delete R[t],!0)}function U(){return R}class O{constructor(e,s,n){this.name=e,this.type=s,this.magnitude=n,this.id=O.idCounter++,s==="magnetic"&&(this.magneticMagnitude=n[2]),Re(this)}destroy(){De(this.id)}}O.idCounter=0;class fe extends O{constructor(e,s,n,i=[0,0]){super(e,s,n);this.position=i}}class ge extends O{constructor(e,s,n){super(e,s,n)}}class me extends ge{constructor(e,s){super(e,"gravity");this.centralObject=s,this.mass=s.mass,this.center=s.position}calculateForceGravity(e){if(e===this.centralObject)return[0,0];const s=[0,0],n=e.position[0]-this.center[0],i=e.position[1]-this.center[1],a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));return s[0]=-(this.mass*e.mass*pe.G)/Math.pow(a,2)*n/a,s[1]=-(this.mass*e.mass*pe.G)/Math.pow(a,2)*i/a,s}}class Ve{constructor(){this.objectList={},this.fieldList={},this.objectList=J(),this.fieldList=U()}analyzeAll(e){const s=Object.values(this.objectList);for(const n of s)n.calculateAcceleration(e)}}class qe{constructor(e){this.loopFuncs=[],this.status="running",this.speed=1,this.config=e,this.run(),this.analyzer=new Ve}run(){this.createLoop(),this.status="running"}stop(){this.status="stopped"}pause(){this.status="paused"}resume(){this.status="running"}createLoop(){let e=0,s=0,n=this;this.loop=i=>{if(typeof this.speed!="number"&&(this.speed=parseFloat(this.speed)),n.status==="paused")return requestAnimationFrame(this.loop);if(n.status==="running"){let a=i-s;s=i,e++;for(let o=0;o<this.config.refreshRate*this.speed;o++)n.update();for(let o of n.loopFuncs)o(e,a);requestAnimationFrame(this.loop)}else if(n.status==="stopped"){this.loop=void 0;return}},requestAnimationFrame(this.loop)}update(){this.analyzer.analyzeAll(this.config.refreshRate),this.moveAllObjects()}addLoop(e){this.loopFuncs.push(e)}removeLoop(e){this.loopFuncs.splice(this.loopFuncs.indexOf(e),1)}moveAllObjects(){const e=Object.values(J());for(const s of e)s.move(this.config.refreshRate)}setSpeed(e){this.speed=e}}class H extends fe{constructor(e,s,n,i=[0,0]){super(e,"electric",s);this.setShape(n),this.position=i}isInField(e,s=[0,0]){return this.shape.isInShape(e.position,s)}calculateForceElectic(e){if(!this.isInField(e,this.position))return[0,0];const s=[0,0],n=this.magnitude[0]*e.charge,i=this.magnitude[1]*e.charge;return s[0]=n,s[1]=i,s}setShape(e){this.shape=e}}class D{constructor(e,s){this.mass=0,this.velocity=[0,0],this.acceleration=[0,0],this.forces=[],this.position=[0,0],this.charge=0,this.name=e,this.id=D.idCounter++,this.gravityField=new me(this.name,this),Te(this),this.setConfig(s)}setConfig(e){e.description&&(this.description=e.description),e.mass&&this.setMass(e.mass),e.position&&this.setPosition(e.position[0],e.position[1]),e.velocity&&this.setVelocity(e.velocity[0],e.velocity[1]),e.charge&&this.setCharge(e.charge),e.shape&&this.setShape(e.shape)}setPosition(e=this.position[0],s=this.position[1]){this.position[0]=e,this.position[1]=s}setShape(e){this.shape=e}setMass(e){this.mass=e,this.gravityField.mass=e}addForce(e){this.forces.push(e)}removeForce(e){this.forces.splice(this.forces.indexOf(e),1)}addAcceleration(e,s){this.acceleration[0]+=e,this.acceleration[1]+=s}isInField(e){if(e instanceof ge)return!0}move(e=1){this.position[0]+=this.velocity[0]/e/60,this.position[1]+=this.velocity[1]/e/60}setVelocity(e,s){this.velocity[0]=e,this.velocity[1]=s}setCharge(e){this.charge=e}calculateForce(){const e=[0,0],s=Object.values(U());for(const n of s)if(n instanceof me){const i=n.calculateForceGravity(this);e[0]+=i[0],e[1]+=i[1]}else if(n instanceof H){const i=n.calculateForceElectic(this);e[0]+=i[0],e[1]+=i[1]}return e}calculateAcceleration(e=1){if(!this.mass)return;const s=this.calculateForce(),n=[0,0];return n[0]=s[0]/this.mass,n[1]=s[1]/this.mass,this.acceleration=n,this.velocity[0]+=n[0]/e/60,this.velocity[1]+=n[1]/e/60,n}}D.idCounter=0;class K{constructor(e,s,n){this.type=e,this.center=s,n instanceof Array?this.setNode(n):this.radius=n}setNode(e){this.node=e,JSON.stringify(e[0])===JSON.stringify(e[e.length-1])&&this.node.pop()}setRadius(e){this.radius=e}isInShape(e,s=[0,0]){if(e=[e[0]-s[0],e[1]-s[1]],this.type==="circle")return Math.pow(e[0]-this.center[0],2)+Math.pow(e[1]-this.center[1],2)<=Math.pow(this.radius,2);if(this.type==="polygon"){let n=0;for(let i=0;i<this.node.length;i++){const a=this.node[i][1],o=(this.node[i+1]||this.node[0])[1];e[1]>=Math.min(a,o)&&e[1]<=Math.max(a,o)&&e[0]<=Math.max(this.node[i][0],this.node[i+1][0])&&n++}return n%2==1}}}class ye extends D{constructor(e,s){super(e,s);this.radius=s.radius,super.setShape(new K("circle",super.position,this.radius))}}const V=new qe({refreshRate:10});ue(()=>Promise.resolve().then(function(){return He}),void 0).then(t=>window.cnb=t);const w=class{constructor(){this.init(),w.div=document.getElementById("app"),this.initDraw()}init(){["objects","fields"].forEach(e=>{const s=document.getElementById(e);w.canvases[e]=s,w.contexts[e]=s.getContext("2d")})}initDraw(){V.addLoop(Q),this.resize(),window.addEventListener("resize",this.resize)}resize(){const e=Object.values(w.canvases);for(const s of e)s.setAttribute("width",`${window.innerWidth}px`),s.setAttribute("height",`${window.innerHeight}px`),s.style.width=`${window.innerWidth}px`,s.style.height=`${window.innerHeight}px`;w.div.setAttribute("width",`${window.innerWidth}px`),w.div.setAttribute("height",`${window.innerHeight}px`),w.div.style.width=`${window.innerWidth}px`,w.div.style.height=`${window.innerHeight}px`,q()}};let v=w;k(v,"canvases",{}),k(v,"contexts",{}),k(v,"div"),k(v,"objectList",J()),k(v,"fieldList",U());function Q(){const t=v.contexts.objects;if(!(t instanceof CanvasRenderingContext2D))return;const e=Object.values(v.objectList);t.clearRect(0,0,parseFloat(v.canvases.objects.style.width||"0"),parseFloat(v.canvases.objects.style.height||"0"));for(const s of e)if(!s.position.some(n=>!Number.isFinite(n))&&s instanceof ye){const[n,i]=s.position,a=t.createRadialGradient(n,i,0,n,i,s.radius);a.addColorStop(0,"white"),a.addColorStop(1,"green"),t.fillStyle=a,t.beginPath(),t.arc(s.position[0],s.position[1],s.radius,0,Math.PI*2),t.fill()}}const Z={};function q(t=!1){const e=v.contexts.fields;if(!(e instanceof CanvasRenderingContext2D))return;const s=Object.values(v.fieldList);e.clearRect(0,0,parseFloat(v.canvases.fields.style.width||"0"),parseFloat(v.canvases.fields.style.height||"0"));for(const n of s)n instanceof fe&&_e(n,t)}function ze(t){const e=v.contexts.fields;if(!(e instanceof CanvasRenderingContext2D))return;e.fillStyle="rgba(100, 100, 255, 0.3)",e.strokeStyle="rgba(68, 219, 255, 0.7)",e.lineWidth=2;const[s,n]=t.position;if(t.shape.type==="circle"){const[i,a]=t.shape.center;e.arc(i+s,a+n,t.shape.radius,0,Math.PI*2)}else if(t.shape.type==="polygon"){e.beginPath(),e.moveTo(t.shape.node[0][0]+s,t.shape.node[0][1]+n);for(const[i,a]of t.shape.node)e.lineTo(i+s,a+n);e.closePath()}e.fill(),e.stroke()}function Ye(t){let e=Math.ceil(Math.log10(t.magnitude[0]**2+t.magnitude[1]**2))*2;const s=[];let n,i,a,o,c,r,u,d,h,f;if(t.shape.type==="circle"?(i=t.shape.radius,a=t.shape.center[0]-i,o=t.shape.center[0]+i,c=t.shape.center[1]-i,r=t.shape.center[1]+i,t.magnitude[1]>t.magnitude[0]?(n=e,e=(o-a)/(r-c)*e*t.magnitude[0]/t.magnitude[1]):n=(o-a)/(r-c)*e*t.magnitude[1]/t.magnitude[0]):(u=t.shape.node,d=u.slice(),h=d.map(p=>p[0]),f=d.map(p=>p[1]),a=Math.min(...h),o=Math.max(...h),c=Math.min(...f),r=Math.max(...f),t.magnitude[1]>t.magnitude[0]?(n=e,e=(o-a)/(r-c)*e*t.magnitude[0]/t.magnitude[1]):n=(o-a)/(r-c)*e*t.magnitude[1]/t.magnitude[0]),t.magnitude[0]!==0)for(let p=0;p<=e;p++){const[y,$]=[a,c+(r-c)*p/e],[x,b]=[o,$+(o-a)*t.magnitude[1]/t.magnitude[0]];s.push({x1:y,x2:x,y1:$,y2:b})}if(t.magnitude[1]!==0)for(let p=0;p<=n;p++){const[y,$]=[a+(o-a)*p/n,c],[x,b]=[y+(r-c)*t.magnitude[0]/t.magnitude[1],r];s.push({x1:y,x2:x,y1:$,y2:b})}return s}function We(t,e){let s=[];const[n,i]=[e.x1,e.y1],[a,o]=[e.x2,e.y2];t.forEach((r,u)=>{const[d,h]=r,[f,p]=t[u===t.length-1?0:u+1];if(d===n&&f===a&&h===i&&p===o||d===a&&f===n&&h===o&&p===i)return;if(ve({x1:d,x2:f,y1:h,y2:p},[n,i]))return s.push([n,i]);if(ve({x1:d,x2:f,y1:h,y2:p},[a,o]))return s.push([a,o]);const y=(d-n)*(p-i)-(h-i)*(f-n),$=(d-a)*(p-o)-(h-o)*(f-a);if(y*$>=0)return;const x=(n-d)*(o-h)-(i-h)*(a-d),b=x+y-$;if(x*b>=0)return;const P=x/($-y),W=d+P*(f-d),Ae=h+P*(p-h);s.push([W,Ae])});const c=Math.sign(e.x1-e.x2);return s.sort((r,u)=>c*(u[0]-r[0])),s=s.filter((r,u)=>u===0||r[0]!==s[u-1][0]||r[1]!==s[u-1][1]),s.map(([r,u],d,h)=>({x1:r,x2:(h[d+1]||[])[0],y1:u,y2:(h[d+1]||[])[1]})).filter((r,u)=>u%2==0&&r.x2)}function ve(t,e){return(t.x1-e[0])*(e[1]-t.y2)==(t.y1-e[1])*(e[0]-t.x2)&&(t.x1-e[0])*(t.x2-e[0])<=0&&(t.y1-e[1])*(t.y2-e[1])<=0}function Ge(t,e,s){const[n,i]=[s.x1,s.y1],[a,o]=[s.x2,s.y2],[c,r]=t,u=(o-i)/(a-n),d=i-u*n,h=u*u+1,f=2*(u*(d-r)-c),p=c*c+(d-r)*(d-r)-e*e,y=f*f-4*h*p;if(y<0)return;const $=Math.sqrt(y),x=(-f+$)/(2*h),b=(-f-$)/(2*h),P=u*x+d,W=u*b+d;return{x1:b,x2:x,y1:W,y2:P}}function Xe(t,e=!1){const s=v.contexts.fields;if(!(s instanceof CanvasRenderingContext2D))return;const n=Ye(t),[i,a]=t.position;let o;if(!Z[t.id]||e){let c=[];if(t.shape.type==="circle")for(const{x1:r,x2:u,y1:d,y2:h}of n)o=Ge(t.shape.center,t.shape.radius,{x1:r,x2:u,y1:d,y2:h}),o&&c.push(o);else if(t.shape.type==="polygon")for(const{x1:r,x2:u,y1:d,y2:h}of n)o=We(t.shape.node,{x1:r,x2:u,y1:d,y2:h}),o.length&&c.push(...o);for(let r=0;r<c.length;r++)c.some((u,d)=>d!==r&&JSON.stringify(u)===JSON.stringify(c[r]))&&(c.splice(r,1),r--);Z[t.id]=o=c}else o=Z[t.id];s.strokeStyle="rgba(68, 219, 255, 0.7)",s.lineWidth=1,s.beginPath();for(const{x1:c,x2:r,y1:u,y2:d}of o){s.moveTo(c+i,u+a),s.lineTo(r+i,d+a);const h=Math.SQRT1_2,[f,p]=[(r-c)*h,(d-u)*h],[y,$]=[r-(f-p)*h/15,d-(f+p)*h/15],[x,b]=[r-(f+p)*h/15,d+(f-p)*h/15];s.moveTo(r+i,d+a),s.lineTo(y+i,$+a),s.moveTo(r+i,d+a),s.lineTo(x+i,b+a)}s.closePath(),s.stroke()}function _e(t,e=!1){ze(t),t instanceof H&&Xe(t,e)}var Je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Draw:v,drawAllObjects:Q,drawAllFields:q,drawField:_e});const _=[new K("circle",[100,100],100),new K("polygon",[0,0],[[0,0],[0,100],[100,100],[100,0]])],ee=new Map;function $e(t){const e=new ye("ball",t.config);return Q(),e}function xe(t){return{mass:"\u8D28\u91CF",radius:"\u534A\u5F84",x:"x\u5750\u6807",y:"y\u5750\u6807",vx:"x\u901F\u5EA6",vy:"y\u901F\u5EA6",charge:"\u7535\u8377",electricMagnitudeX:"x\u573A\u5F3A",electricMagnitudeY:"y\u573A\u5F3A",scale:"\u7F29\u653E",shape:"\u5F62\u72B6"}[t]||t}function be(t,e,s){const n=t.radius,i=(Math.min(e,s)-10)/(n*2);return{radius:n*i}}function te(t,e,s,n){let i=ee.get(t);const a=Fe(t,e,s);if(!i){const o={scale:a.scale,center:a.center};n||(ee.set(t,o),i=o)}return n?t.node.map(o=>[(o[0]-a.center[0])*a.scale+e/2,(o[1]-a.center[1])*a.scale+s/2]):t.node.map(o=>[(o[0]-i.center[0])*i.scale+e/2,(o[1]-i.center[1])*i.scale+s/2])}function Fe(t,e,s){const n=e/s,i=t.node.map(y=>y[1]),a=t.node.map(y=>y[0]),o=Math.min(...a),c=Math.max(...a),r=Math.min(...i),u=Math.max(...i),d=c-o,h=u-r,f=[o+d/2,r+h/2],p=d>h*n?(e-10)/d:(s-10)/h;return{center:f,scale:p}}function we(t,e){return te(_[t],e.width,e.height).map(s=>[s[0]*e.scale+e.dx,s[1]*e.scale+e.dy])}function se(t){return{circle:"\u5706\u5F62",polygon:"\u591A\u8FB9\u5F62"}[t]||"\u672A\u77E5"}function Ue(t){const e=_[t];return e.type==="circle"?[e.center[0],e.center[1]]:_[t].node.slice()}function ie(t){const e=getComputedStyle(t);t.width=parseInt(e.width),t.height=parseInt(e.height)}async function C(t,e){const s=_[t],i=document.getElementById(e.canvas).getContext("2d"),{dx:a,dy:o,width:c,height:r,scale:u}=e;if(i.clearRect(0,0,c,r),i.strokeStyle=e.strokeStyle||"#222",i.lineWidth=2,i.fillStyle=e.fillStyle||"#6495ED",i.beginPath(),s.type==="circle"){const d=be(s,c,r);i.arc(c/2*u+a,r/2*u+o,d.radius*u,0,2*Math.PI),i.fill(),i.stroke(),e.node&&(e.hover===0?i.fillStyle="#777":i.fillStyle="black",i.fillRect(c/2*u+a-5,r/2*u+o-5,10,10))}else{const d=te(s,c,r,e.noCache);i.moveTo(d[0][0]*u+a,d[0][1]*u+o);for(const[h,f]of d)i.lineTo(h*u+a,f*u+o);i.closePath(),i.fill(),i.stroke(),e.node&&d.forEach((h,f)=>{e.hover===f?i.fillStyle="#777":i.fillStyle="black",i.fillRect(h[0]*u+a-5,h[1]*u+o-5,10,10)})}}function Se(t,e,s,n,i){const a=ee.get(t),[o,c]=t.node[e],{scale:r}=i,[u,d]=[o+s/r/a.scale,c+n/r/a.scale];t.type==="circle"||(t.node[e]=[u,d])}function Ce(t){new H("electric",t.config.magnitude,t.config.shape,t.config.position),q()}var He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shapeList:_,addRoundObject:$e,getName:xe,centerCircle:be,centerPolygon:te,getScale:Fe,getComputedNode:we,getShapeTypeName:se,generateNode:Ue,initCanvas:ie,drawShape:C,changeNode:Se,addElectricField:Ce});var A=(t,e)=>{const s=t.__vccOpts||t;for(const[n,i]of e)s[n]=i;return s};let ne={};const Ke=E({name:"ObjectsVue",emits:["choose"],props:{obj:{type:Object,required:!0},index:{required:!0}},data(){return{detail:!1,objectList:X,getName:xe,shapeList:_,configs:{x:"0",y:"0",vx:"0",vy:"0",mass:"1",radius:"50",charge:"0",shape:"1",electricMagnitudeX:"100",electricMagnitudeY:"100",scale:"1"},shape:ne}},methods:{createConfig(t,e){const s={};for(const n in t){const i=parseFloat(t[n]);isNaN(i)?s[n]=t[n]:s[n]=i}return s.position=[s.x,s.y],s.velocity=[s.vx,s.vy],e==="electricField"&&(s.magnitude=[parseFloat(s.electricMagnitudeX),parseFloat(s.electricMagnitudeY)]),s.shape=_[parseInt(s.shape)],{type:e,config:s}},create(t,e){const s=this.createConfig(t,e);switch(e){case"ball":return $e(s);case"electricField":return Ce(s)}},triggerDetail(){this.detail=!this.detail,requestAnimationFrame(()=>{const t=document.getElementById("select-canvas");!t||C(parseInt(this.configs.shape),{dx:0,dy:0,canvas:"select-canvas",scale:1,width:t.width,height:t.height,strokeStyle:"#ddd",noCache:!0})})}},mounted(){const t=JSON.parse(JSON.stringify(this.shape)),e={get:(s,n)=>n in s?s[n]:0,set:(s,n,i)=>{if(n!==this.index)return!0;s[n]=i,this.configs.shape=i.toString();const a=document.getElementById("select-canvas");return C(parseInt(this.configs.shape),{dx:0,dy:0,canvas:"select-canvas",scale:1,width:a.width,height:a.height,strokeStyle:"#ddd"}),!0}};ne=this.shape=new Proxy(t,e)}}),Qe=t=>(I("data-v-534307f2"),t=t(),M(),t),Ze={id:"brief"},et=["src"],tt={class:"text"},st={key:0},it={class:"detail"},nt={class:"input-prompt"},ot={key:0,id:"input-box"},at=["onUpdate:modelValue"],rt={id:"unit"},ct={key:1,id:"select-box"},lt=Qe(()=>l("canvas",{id:"select-canvas"},null,-1));function dt(t,e,s,n,i,a){return g(),m(S,null,[l("div",Ze,[l("button",{id:"detail",onClick:e[0]||(e[0]=o=>t.triggerDetail())},F(t.detail?"\u7B80\u7565":"\u8BE6\u7EC6"),1),l("img",{id:"image",src:`/source/${t.obj.img}`},null,8,et),l("span",tt,F(t.obj.name),1),l("button",{class:"create",onClick:e[1]||(e[1]=o=>t.create(t.configs,t.obj.type))},"\u521B\u5EFA")]),t.detail?(g(),m("hr",st)):j("",!0),t.detail?(g(!0),m(S,{key:1},B(t.obj.config,o=>(g(),m("div",it,[l("span",nt,F(t.getName(o.split(":")[0])),1),o.split(":")[1]!=="choose"?(g(),m("span",ot,[ce(l("input",{class:"input",type:"text","onUpdate:modelValue":c=>t.configs[o.split(":")[0]]=c},null,8,at),[[le,t.configs[o.split(":")[0]],void 0,{trim:!0}]]),l("span",rt,F(o.split(":")[1]),1)])):(g(),m("div",ct,[lt,l("button",{onClick:e[2]||(e[2]=c=>t.$emit("choose",t.index)),class:"select-button"},"\u9009\u62E9")]))]))),256)):j("",!0)],64)}var ut=A(Ke,[["render",dt],["__scopeId","data-v-534307f2"]]);const ht=E({name:"ObjectsVue",emits:["choose"],data(){return{objectList:X}},components:{OneObjectVue:ut},methods:{choose(t){this.$emit("choose",t)}}}),pt={class:"object"};function ft(t,e,s,n,i,a){const o=L("one-object-vue");return g(!0),m(S,null,B(t.objectList,(c,r)=>(g(),m("div",pt,[G(o,{onChoose:t.choose,obj:c,index:r},null,8,["onChoose","obj","index"])]))),256)}var gt=A(ht,[["render",ft]]);async function z(t){const e=document.getElementsByClassName("shape-canvas");Array.from(e).forEach(async n=>{ie(n);const i=n.id,a=i.split("-");await C(parseInt(a[3]),{canvas:i,node:!1,dx:0,dy:0,scale:1,strokeStyle:t||"#ccc",width:n.width,height:n.height,noCache:!0})})}const mt=E({emits:["editShape"],name:"Shapes",data:()=>({shapeList:_}),methods:{drawThumbnail:z},async mounted(){await z()}}),yt=t=>(I("data-v-571fe5fe"),t=t(),M(),t),vt={class:"shape"},_t=["id"],$t=["onClick","id"],xt=yt(()=>l("button",{id:"create"},"\u521B\u5EFA\u65B0\u5F62\u72B6",-1));function bt(t,e,s,n,i,a){return g(),m(S,null,[(g(!0),m(S,null,B(t.shapeList,(o,c)=>(g(),m("div",vt,[l("canvas",{width:"100",height:"50",id:`shape-${o.id}-${o.type}-${c}`,class:"shape-canvas"},null,8,_t),l("button",{onClick:r=>t.$emit("editShape",c),id:`button-${o.id}`,class:"button"},"\u7F16\u8F91",8,$t)]))),256)),xt],64)}var Ft=A(mt,[["render",bt],["__scopeId","data-v-571fe5fe"]]),wt="/assets/lessen.7b4a6772.png",St="/assets/enlarge.d3a5bf03.png";const Y={};let N=-1,oe=!1;const Ct=E({emits:["confirm","cancel"],name:"ShapeEditor",props:{index:{type:Number,required:!0}},data(){return{shapeList:_,scale:1,dx:0,dy:0,width:0,height:0}},methods:{getShapeTypeName:se,listenMove(t,e){const s=_[e],n={canvas:"editor-canvas",node:!0,dx:this.dx,dy:this.dy,scale:this.scale,width:this.width,height:this.height};if(oe){if(s.type==="circle")return;Se(s,N,t.movementX,t.movementY,n),C(e,n);return}const i=[];s.type==="circle"?i.push([s.center[0]+this.dx,s.center[1]+this.dy]):i.push(...we(e,{dx:this.dx,dy:this.dy,scale:this.scale,width:this.width,height:this.height}));const a=i.findIndex(([o,c],r)=>Math.abs(t.offsetX-o)<=10&&Math.abs(t.offsetY-c)<=10);if(n.hover=a,a===-1){N>=0&&(N=-1,C(e,n));return}N=a,C(e,n)},triggerScale(t){t==="enlarge"?this.scale*=1.1:this.scale/=1.1},listenDown(t,e){N!==-1&&(oe=!0)},listenUp(t,e){oe=!1},cancel(t){this.$emit("cancel",Y,_[t])}},async mounted(){const t=document.getElementById("editor-canvas");ie(t),this.width=t.width,this.height=t.height,await C(this.index,{scale:this.scale,dx:this.dx,dy:this.dy,canvas:"editor-canvas",node:!0,width:this.width,height:this.height});const e=_[this.index];e.type==="circle"?(e.center.slice(),Y.radius=e.radius,Y.center=e.center.slice()):(e.node.slice(),Y.node=e.node.slice())},watch:{scale(t,e){const s=(t-e)*this.width/2,n=(t-e)*this.height/2;this.dx-=s,this.dy-=n,requestAnimationFrame(()=>{C(this.index,{scale:this.scale,dx:this.dx,dy:this.dy,canvas:"editor-canvas",node:!0,width:this.width,height:this.height})})}}}),ae=t=>(I("data-v-e9a32e32"),t=t(),M(),t),Et={id:"root"},At={id:"back"},kt={id:"description"},jt={class:"text"},It=ae(()=>l("span",{class:"text",id:"center"},"\u56FE\u5F62\u7F16\u8F91\u5668",-1)),Mt={class:"text"},Bt=ae(()=>l("hr",{id:"top"},null,-1)),Lt={id:"editor"},Ot=ae(()=>l("hr",{id:"bottom"},null,-1)),Nt={id:"tools"},Pt=Ie('<div id="leftTool" data-v-e9a32e32><button class="tool" data-v-e9a32e32>\u64A4\u9500</button><button class="tool" data-v-e9a32e32>\u91CD\u505A</button></div><div id="middleTool" data-v-e9a32e32><button class="tool" id="detail" data-v-e9a32e32>\u8BE6\u7EC6\u4FE1\u606F</button></div>',2),Tt={id:"rightTool"};function Rt(t,e,s,n,i,a){return g(),m("div",Et,[l("div",At,[l("div",kt,[l("span",jt,"\u56FE\u5F62id\uFF1A"+F(t.shapeList[t.index].id),1),It,l("span",Mt,"\u56FE\u5F62\u7C7B\u578B\uFF1A"+F(t.getShapeTypeName(t.shapeList[t.index].type)),1)]),Bt,l("div",Lt,[l("img",{class:"scale",onClick:e[0]||(e[0]=o=>t.triggerScale("lessen")),id:"lessen",src:wt}),l("img",{class:"scale",onClick:e[1]||(e[1]=o=>t.triggerScale("enlarge")),id:"enlarge",src:St}),l("canvas",{onMouseup:e[2]||(e[2]=o=>t.listenUp(o,t.index)),onMousedown:e[3]||(e[3]=o=>t.listenDown(o,t.index)),onMousemove:e[4]||(e[4]=o=>t.listenMove(o,t.index)),id:"editor-canvas"},null,32)]),Ot,l("div",Nt,[Pt,l("div",Tt,[l("button",{class:"tool",onClick:e[5]||(e[5]=o=>t.cancel(t.index))},"\u53D6\u6D88"),l("button",{class:"tool",onClick:e[6]||(e[6]=o=>t.$emit("confirm"))},"\u786E\u5B9A")])])])])}var Dt=A(Ct,[["render",Rt],["__scopeId","data-v-e9a32e32"]]);const Vt=E({name:"ShapeSelector",emits:["select","cancel"],props:{index:String},data(){return{shapeList:_,getShapeTypeName:se}},async mounted(){await z("#222")}}),re=t=>(I("data-v-a7b48c00"),t=t(),M(),t),qt={id:"root"},zt={id:"back"},Yt=re(()=>l("div",{id:"select"},"\u9009\u62E9\u56FE\u5F62",-1)),Wt=re(()=>l("hr",null,null,-1)),Gt={id:"shapes"},Xt={class:"shape"},Jt=["id"],Ut={class:"shape-text"},Ht={class:"shape-text"},Kt=["onClick"],Qt=re(()=>l("hr",null,null,-1)),Zt={id:"tools"};function es(t,e,s,n,i,a){return g(),m("div",qt,[l("div",zt,[Yt,Wt,l("div",Gt,[(g(!0),m(S,null,B(t.shapeList,(o,c)=>(g(),m("div",Xt,[l("canvas",{class:"shape-canvas",id:`shape-${o.id}-${o.type}-${c}`},null,8,Jt),l("span",Ut,"\u56FE\u5F62id\uFF1A"+F(o.id),1),l("span",Ht,"\u56FE\u5F62\u7C7B\u578B\uFF1A"+F(t.getShapeTypeName(o.type)),1),l("button",{class:"shape-select",onClick:r=>t.$emit("select",c,t.index)},"\u9009\u62E9",8,Kt)]))),256))]),Qt,l("div",Zt,[l("button",{class:"tool",onClick:e[0]||(e[0]=o=>t.$emit("cancel"))},"\u53D6\u6D88"),l("button",{class:"tool",onClick:e[1]||(e[1]=o=>t.$emit("cancel"))},"\u786E\u5B9A")])])])}var ts=A(Vt,[["render",es],["__scopeId","data-v-a7b48c00"]]);const ss=Object.values(X),is=[{id:"objects",text:"\u7269\u4F53"},{id:"shapes",text:"\u5F62\u72B6"}];function ns(t){t.id==="fold"||t.id==="list"?t.style.right="300px":t.style.right="0px"}const os=E({name:"RightBar",data:()=>({objectList:ss,shapeList:_,selectList:is,folded:!1,selected:"objects-vue",editing:!1,editIndex:0,selecting:!1,beSelectedIndex:"electricField"}),provide(){return{shapeSelect:0}},methods:{triggerFold(){const t=document.getElementsByClassName("bar");Array.from(t).forEach(n=>{let i=parseFloat(n.style.right);isNaN(i)&&(ns(n),i=parseFloat(n.style.right)),this.folded?n.style.right=n.id==="list"?`${i+380}px`:`${i+300}px`:n.style.right=n.id==="list"?`${i-380}px`:`${i-300}px`});const s=document.getElementById("fold-text");s.style.transform=this.folded?"rotateY(0deg)":"rotateY(180deg)",this.folded=!this.folded},select(t){this.selected=`${t}-vue`},editShape(t){this.editIndex=t,this.editing=!0},async confirmEdit(){this.editing=!1,await z(),q(!0)},cancelEdit(t,e){this.editing=!1,e.type==="circle"&&t.radius&&t.center?(e.radius=t.radius,e.center=t.center.slice()):t.node&&(e.node=t.node)},selectShape(t,e){ne[e]=t},openSelectShape(t){this.beSelectedIndex=t,requestAnimationFrame(()=>{this.selecting=!0})}},components:{ObjectsVue:gt,ShapesVue:Ft,ShapeEditorVue:Dt,ShapeSelectorVue:ts}}),as=t=>(I("data-v-48466250"),t=t(),M(),t),rs={id:"right-bar",class:"bar"},cs=as(()=>l("div",{id:"fold-text"},"\u25B6",-1)),ls=[cs],ds={id:"list",class:"bar"},us=["onClick","status"];function hs(t,e,s,n,i,a){const o=L("ShapeEditorVue"),c=L("ShapeSelectorVue");return g(),m(S,null,[l("div",rs,[(g(),T(Be,null,[(g(),T(Me(t.selected),{onEditShape:t.editShape,onChoose:t.openSelectShape},null,8,["onEditShape","onChoose"]))],1024))]),l("div",{id:"fold",class:"bar",onClick:e[0]||(e[0]=r=>t.triggerFold())},ls),l("div",ds,[(g(!0),m(S,null,B(t.selectList,r=>(g(),m("div",{onClick:u=>t.select(r.id),class:"select",status:t.selected===`${r.id}-vue`},F(r.text),9,us))),256))]),t.editing?(g(),T(o,{key:0,onConfirm:t.confirmEdit,onCancel:t.cancelEdit,index:t.editIndex},null,8,["onConfirm","onCancel","index"])):j("",!0),t.selecting?(g(),T(c,{key:1,onCancel:e[1]||(e[1]=r=>t.selecting=!1),onSelect:t.selectShape,index:t.beSelectedIndex},null,8,["onSelect","index"])):j("",!0)],64)}var ps=A(os,[["render",hs],["__scopeId","data-v-48466250"]]),fs="/assets/settings.0c9bdc27.png",gs="/assets/play.0bc8270f.png",ms="/assets/pause.429c644f.png",ys="/assets/speeddown.1f507ff4.png",vs="/assets/speedup.58720e73.png";const _s=E({name:"LeftBar",data:()=>({app:V,folded:!1,status:"running"}),methods:{triggerPlaying(){const t=this.app.status;t==="running"?V.pause():t==="paused"&&V.resume(),this.status=this.app.status},triggerFold(){const t=document.getElementById("settings"),e=/rotate\([0-9]+deg\)/.exec(t.style.transform)||[],s=parseInt((/[0-9]+/.exec(e[0])||[])[0]||"0");t.style.transform=`rotate(${s+90}deg)`;const n=document.getElementById("left-bar"),i=document.getElementById("hr");this.folded?(n.style.width="375px",i.style.display="block"):(n.style.width="48px",setTimeout(()=>{i.style.display="none"},500)),this.folded=!this.folded},changeSpeed(t){const e=this.app.speed;t==="up"?e<10&&(this.app.speed=parseFloat((e+.1).toFixed(1))):e>.1&&(this.app.speed=parseFloat((e-.1).toFixed(1)))}}}),Ee=t=>(I("data-v-68f08884"),t=t(),M(),t),$s={id:"left-bar",style:{"z-index":"200"}},xs=Ee(()=>l("span",{id:"hr"},null,-1)),bs=Ee(()=>l("span",{id:"hr"},null,-1)),Fs={id:"speed",style:{"padding-left":"2px"}};function ws(t,e,s,n,i,a){return g(),m("div",$s,[l("img",{onClick:e[0]||(e[0]=o=>t.triggerFold()),id:"settings",class:"settings",src:fs,style:{width:"48px",height:"48px"}}),xs,t.status==="paused"?(g(),m("img",{key:0,onClick:e[1]||(e[1]=o=>t.triggerPlaying()),class:"settings",id:"play",src:gs,style:{width:"40px","margin-right":"6px"}})):j("",!0),t.status==="running"?(g(),m("img",{key:1,onClick:e[2]||(e[2]=o=>t.triggerPlaying()),class:"settings",id:"pause",src:ms,style:{width:"40px","margin-right":"6px"}})):j("",!0),l("img",{class:"settings",onClick:e[3]||(e[3]=o=>t.changeSpeed("down")),id:"speeddown",src:ys,style:{width:"40px","margin-right":"6px"}}),ce(l("input",{type:"range",max:"10",min:"0.1",step:"0.1","onUpdate:modelValue":e[4]||(e[4]=o=>t.app.speed=o)},null,512),[[le,t.app.speed]]),l("img",{class:"settings",onClick:e[5]||(e[5]=o=>t.changeSpeed("up")),id:"speedup",src:vs,style:{width:"40px","margin-right":"6px"}}),bs,l("span",Fs,"\xD7"+F(t.app.speed),1)])}var Ss=A(_s,[["render",ws],["__scopeId","data-v-68f08884"]]);const Cs=E({name:"App",data(){return{rightToolbar:!0}},components:{RightBar:ps,LeftBar:Ss}}),Es=l("canvas",{id:"objects"},null,-1),As=l("canvas",{id:"fields"},null,-1);function ks(t,e,s,n,i,a){const o=L("RightBar"),c=L("LeftBar");return g(),m(S,null,[Es,As,G(o),G(c)],64)}var js=A(Cs,[["render",ks]]);Le(js).mount("#app");ue(()=>Promise.resolve().then(function(){return Je}),void 0).then(t=>new t.Draw);
