var je=Object.defineProperty;var Ie=(t,e,s)=>e in t?je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var j=(t,e,s)=>(Ie(t,typeof e!="symbol"?e+"":e,s),s);import{d as A,c as g,a as d,t as F,b as I,F as C,r as N,o as f,w as he,v as ue,p as B,e as L,f as T,g as J,h as Be,i as D,j as Le,K as Oe,k as Ne}from"./vendor.76bb25af.js";const Te=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}};Te();const Pe="modulepreload",pe={},Re="/",fe=function(e,s){return!s||s.length===0?e():Promise.all(s.map(n=>{if(n=`${Re}${n}`,n in pe)return;pe[n]=!0;const i=n.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${a}`))return;const o=document.createElement("link");if(o.rel=i?"stylesheet":Pe,i||(o.as="script",o.crossOrigin=""),o.href=n,document.head.appendChild(o),i)return new Promise((l,r)=>{o.addEventListener("load",l),o.addEventListener("error",r)})})).then(()=>e())},U={ball:{type:"ball",name:"\u5C0F\u7403",img:"ball.png",config:["radius:m","x:m","y:m","mass:kg","vx:m/s","vy:m/s","charge:C"]},electricField:{type:"electricField",name:"\u7535\u573A",img:"electricField.png",config:["x:m","y:m","scale:","electricMagnitudeX:N/C","electricMagnitudeY:N/C","shape:choose"]}},ge={},q={},me={G:667259e-16,c:299792458,k:8987551787368176e-6,e:1602176634e-28};function Ve(t){ge[t.id]=t}function H(){return ge}function De(t){q[t.id]=t}function qe(t){return q[t]===void 0?!1:(delete q[t],!0)}function K(){return q}class P{constructor(e,s,n){this.name=e,this.type=s,this.magnitude=n,this.id=P.idCounter++,s==="magnetic"&&(this.magneticMagnitude=n[2]),De(this)}destroy(){qe(this.id)}}P.idCounter=0;class ye extends P{constructor(e,s,n,i=[0,0]){super(e,s,n);this.position=i}}class ve extends P{constructor(e,s,n){super(e,s,n)}}class _e extends ve{constructor(e,s){super(e,"gravity");this.centralObject=s,this.mass=s.mass,this.center=s.position}calculateForceGravity(e){if(e===this.centralObject)return[0,0];const s=[0,0],n=e.position[0]-this.center[0],i=e.position[1]-this.center[1],a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));return s[0]=-(this.mass*e.mass*me.G)/Math.pow(a,2)*n/a,s[1]=-(this.mass*e.mass*me.G)/Math.pow(a,2)*i/a,s}}class ze{constructor(){this.objectList={},this.fieldList={},this.objectList=H(),this.fieldList=K()}analyzeAll(e){const s=Object.values(this.objectList);for(const n of s)n.calculateAcceleration(e)}}class Ye{constructor(e){this.loopFuncs=[],this.status="running",this.speed=1,this.config=e,this.run(),this.analyzer=new ze}run(){this.createLoop(),this.status="running"}stop(){this.status="stopped"}pause(){this.status="paused"}resume(){this.status="running"}createLoop(){let e=0,s=0,n=this;this.loop=i=>{if(typeof this.speed!="number"&&(this.speed=parseFloat(this.speed)),n.status==="paused")return requestAnimationFrame(this.loop);if(n.status==="running"){let a=i-s;s=i,e++;for(let o=0;o<this.config.refreshRate*this.speed;o++)n.update();for(let o of n.loopFuncs)o(e,a);requestAnimationFrame(this.loop)}else if(n.status==="stopped"){this.loop=void 0;return}},requestAnimationFrame(this.loop)}update(){this.analyzer.analyzeAll(this.config.refreshRate),this.moveAllObjects()}addLoop(e){this.loopFuncs.push(e)}removeLoop(e){this.loopFuncs.splice(this.loopFuncs.indexOf(e),1)}moveAllObjects(){const e=Object.values(H());for(const s of e)s.move(this.config.refreshRate)}setSpeed(e){this.speed=e}}class Q extends ye{constructor(e,s,n,i=[0,0]){super(e,"electric",s);this.setShape(n),this.position=i}isInField(e,s=[0,0]){return this.shape.isInShape(e.position,s)}calculateForceElectic(e){if(!this.isInField(e,this.position))return[0,0];const s=[0,0],n=this.magnitude[0]*e.charge,i=this.magnitude[1]*e.charge;return s[0]=n,s[1]=i,s}setShape(e){this.shape=e}}class z{constructor(e,s){this.mass=0,this.velocity=[0,0],this.acceleration=[0,0],this.forces=[],this.position=[0,0],this.charge=0,this.name=e,this.id=z.idCounter++,this.gravityField=new _e(this.name,this),Ve(this),this.setConfig(s)}setConfig(e){e.description&&(this.description=e.description),e.mass&&this.setMass(e.mass),e.position&&this.setPosition(e.position[0],e.position[1]),e.velocity&&this.setVelocity(e.velocity[0],e.velocity[1]),e.charge&&this.setCharge(e.charge),e.shape&&this.setShape(e.shape)}setPosition(e=this.position[0],s=this.position[1]){this.position[0]=e,this.position[1]=s}setShape(e){this.shape=e}setMass(e){this.mass=e,this.gravityField.mass=e}addForce(e){this.forces.push(e)}removeForce(e){this.forces.splice(this.forces.indexOf(e),1)}addAcceleration(e,s){this.acceleration[0]+=e,this.acceleration[1]+=s}isInField(e){if(e instanceof ve)return!0}move(e=1){this.position[0]+=this.velocity[0]/e/60,this.position[1]+=this.velocity[1]/e/60}setVelocity(e,s){this.velocity[0]=e,this.velocity[1]=s}setCharge(e){this.charge=e}calculateForce(){const e=[0,0],s=Object.values(K());for(const n of s)if(n instanceof _e){const i=n.calculateForceGravity(this);e[0]+=i[0],e[1]+=i[1]}else if(n instanceof Q){const i=n.calculateForceElectic(this);e[0]+=i[0],e[1]+=i[1]}return e}calculateAcceleration(e=1){if(!this.mass)return;const s=this.calculateForce(),n=[0,0];return n[0]=s[0]/this.mass,n[1]=s[1]/this.mass,this.acceleration=n,this.velocity[0]+=n[0]/e/60,this.velocity[1]+=n[1]/e/60,n}}z.idCounter=0;class Z{constructor(e,s,n){this.type=e,this.center=s,n instanceof Array?this.setNode(n):this.radius=n}setNode(e){this.node=e,JSON.stringify(e[0])===JSON.stringify(e[e.length-1])&&this.node.pop()}setRadius(e){this.radius=e}isInShape(e,s=[0,0]){if(e=[e[0]-s[0],e[1]-s[1]],this.type==="circle")return Math.pow(e[0]-this.center[0],2)+Math.pow(e[1]-this.center[1],2)<=Math.pow(this.radius,2);if(this.type==="polygon"){let n=0;for(let i=0;i<this.node.length;i++){const a=this.node[i][1],o=(this.node[i+1]||this.node[0])[1],l=this.node[i][0],r=(this.node[i+1]||this.node[0])[0];e[1]>=Math.min(a,o)&&e[1]<=Math.max(a,o)&&(l-r)/(a-o)*(e[1]-a)+l>=e[0]&&n++}return n%2==1}}}class $e extends z{constructor(e,s){super(e,s);this.radius=s.radius,super.setShape(new Z("circle",super.position,this.radius))}}const Y=new Ye({refreshRate:10});fe(()=>Promise.resolve().then(function(){return Qe}),void 0).then(t=>window.cnb=t);const w=class{constructor(){this.init(),w.div=document.getElementById("app"),this.initDraw()}init(){["objects","fields"].forEach(e=>{const s=document.getElementById(e);w.canvases[e]=s,w.contexts[e]=s.getContext("2d")})}initDraw(){Y.addLoop(ee),this.resize(),window.addEventListener("resize",this.resize)}resize(){const e=Object.values(w.canvases);for(const s of e)s.setAttribute("width",`${window.innerWidth}px`),s.setAttribute("height",`${window.innerHeight}px`),s.style.width=`${window.innerWidth}px`,s.style.height=`${window.innerHeight}px`;w.div.setAttribute("width",`${window.innerWidth}px`),w.div.setAttribute("height",`${window.innerHeight}px`),w.div.style.width=`${window.innerWidth}px`,w.div.style.height=`${window.innerHeight}px`,W()}};let $=w;j($,"canvases",{}),j($,"contexts",{}),j($,"div"),j($,"objectList",H()),j($,"fieldList",K());function ee(){const t=$.contexts.objects;if(!(t instanceof CanvasRenderingContext2D))return;const e=Object.values($.objectList);t.clearRect(0,0,parseFloat($.canvases.objects.style.width||"0"),parseFloat($.canvases.objects.style.height||"0"));for(const s of e)if(!s.position.some(n=>!Number.isFinite(n))&&s instanceof $e){const[n,i]=s.position,a=t.createRadialGradient(n,i,0,n,i,s.radius);a.addColorStop(0,"white"),a.addColorStop(1,"green"),t.fillStyle=a,t.beginPath(),t.arc(s.position[0],s.position[1],s.radius,0,Math.PI*2),t.fill()}}const te={};function W(t=!1){const e=$.contexts.fields;if(!(e instanceof CanvasRenderingContext2D))return;const s=Object.values($.fieldList);e.clearRect(0,0,parseFloat($.canvases.fields.style.width||"0"),parseFloat($.canvases.fields.style.height||"0"));for(const n of s)n instanceof ye&&be(n,t)}function We(t){const e=$.contexts.fields;if(!(e instanceof CanvasRenderingContext2D))return;e.fillStyle="rgba(100, 100, 255, 0.3)",e.strokeStyle="rgba(68, 219, 255, 0.7)",e.lineWidth=2;const[s,n]=t.position;if(t.shape.type==="circle"){const[i,a]=t.shape.center;e.beginPath(),e.arc(i+s,a+n,t.shape.radius,0,Math.PI*2),e.closePath()}else if(t.shape.type==="polygon"){e.beginPath(),e.moveTo(t.shape.node[0][0]+s,t.shape.node[0][1]+n);for(const[i,a]of t.shape.node)e.lineTo(i+s,a+n);e.closePath()}e.fill(),e.stroke()}function Ge(t){let e=Math.ceil(Math.log10(t.magnitude[0]**2+t.magnitude[1]**2))*2;const s=[];let n,i,a,o,l,r,c,u,h,p;const m=Math.sign(t.magnitude[0]),_=Math.sign(t.magnitude[1]);if(t.shape.type==="circle"?(i=t.shape.radius,a=t.shape.center[0]-i*(m||1),o=t.shape.center[0]+i*(m||1),l=t.shape.center[1]-i*(_||1),r=t.shape.center[1]+i*(_||1)):(c=t.shape.node,u=c.slice(),h=u.map(y=>y[0]),p=u.map(y=>y[1]),a=m>=0?Math.min(...h):Math.max(...h),o=m<0?Math.min(...h):Math.max(...h),l=_>=0?Math.min(...p):Math.max(...p),r=_<0?Math.min(...p):Math.max(...p)),Math.abs(t.magnitude[1])>Math.abs(t.magnitude[0])?(n=e,e=(o-a)/(r-l)*e*t.magnitude[0]/t.magnitude[1]):n=(o-a)/(r-l)*e*t.magnitude[1]/t.magnitude[0],t.magnitude[0]!==0)for(let y=0;y<=e;y++){const[x,b]=[a,l+(r-l)*y/e],[S,k]=[o,b+(o-a)*t.magnitude[1]/t.magnitude[0]];s.push({x1:x,x2:S,y1:b,y2:k})}if(t.magnitude[1]!==0)for(let y=0;y<=n;y++){const[x,b]=[a+(o-a)*y/n,l],[S,k]=[x+(r-l)*t.magnitude[0]/t.magnitude[1],r];s.push({x1:x,x2:S,y1:b,y2:k})}return s}function Xe(t,e){let s=[];const[n,i]=[e.x1,e.y1],[a,o]=[e.x2,e.y2];t.forEach((r,c)=>{const[u,h]=r,[p,m]=t[c===t.length-1?0:c+1];if(u===n&&p===a&&h===i&&m===o||u===a&&p===n&&h===o&&m===i)return;if(xe({x1:u,x2:p,y1:h,y2:m},[n,i]))return s.push([n,i]);if(xe({x1:u,x2:p,y1:h,y2:m},[a,o]))return s.push([a,o]);const _=(u-n)*(m-i)-(h-i)*(p-n),y=(u-a)*(m-o)-(h-o)*(p-a);if(_*y>=0)return;const x=(n-u)*(o-h)-(i-h)*(a-u),b=x+_-y;if(x*b>=0)return;const S=x/(y-_),k=u+S*(p-u),Me=h+S*(m-h);s.push([k,Me])});const l=Math.sign(e.x1-e.x2);return s.sort((r,c)=>l*(c[0]-r[0])),s=s.filter((r,c)=>c===0||r[0]!==s[c-1][0]||r[1]!==s[c-1][1]),s.map(([r,c],u,h)=>({x1:r,x2:(h[u+1]||[])[0],y1:c,y2:(h[u+1]||[])[1]})).filter((r,c)=>c%2==0&&typeof r.x2=="number")}function xe(t,e){return(t.x1-e[0])*(e[1]-t.y2)==(t.y1-e[1])*(e[0]-t.x2)&&(t.x1-e[0])*(t.x2-e[0])<=0&&(t.y1-e[1])*(t.y2-e[1])<=0}function Je(t,e,s){const[n,i]=[s.x1,s.y1],[a,o]=[s.x2,s.y2],[l,r]=t,c=(o-i)/(a-n),u=i-c*n,h=c*c+1,p=2*(c*(u-r)-l),m=l*l+(u-r)*(u-r)-e*e,_=p*p-4*h*m;if(_<0)return;const y=Math.sqrt(_),x=(-p+y)/(2*h),b=(-p-y)/(2*h),S=c*x+u,k=c*b+u;return{x1:n>a?x:b,x2:n<a?x:b,y1:i>o?S:k,y2:i<o?S:k}}function Ue(t,e=!1){const s=$.contexts.fields;if(!(s instanceof CanvasRenderingContext2D))return;const n=Ge(t),[i,a]=t.position;let o;if(!te[t.id]||e){let r=[];if(t.shape.type==="circle")for(const{x1:c,x2:u,y1:h,y2:p}of n)o=Je(t.shape.center,t.shape.radius,{x1:c,x2:u,y1:h,y2:p}),o&&r.push(o);else if(t.shape.type==="polygon")for(const{x1:c,x2:u,y1:h,y2:p}of n)o=Xe(t.shape.node,{x1:c,x2:u,y1:h,y2:p}),o.length&&r.push(...o);for(let c=0;c<r.length;c++)r.some((u,h)=>h!==c&&JSON.stringify(u)===JSON.stringify(r[c]))&&(r.splice(c,1),c--);te[t.id]=o=r}else o=te[t.id];s.strokeStyle="rgba(68, 219, 255, 0.7)",s.lineWidth=1,s.beginPath();const l=Math.SQRT1_2;for(const{x1:r,x2:c,y1:u,y2:h}of o){s.moveTo(r+i,u+a),s.lineTo(c+i,h+a);const[p,m]=[(c-r)*l,(h-u)*l],[_,y]=[c-(p-m)*l/15,h-(p+m)*l/15],[x,b]=[c-(p+m)*l/15,h+(p-m)*l/15];s.moveTo(c+i,h+a),s.lineTo(_+i,y+a),s.moveTo(c+i,h+a),s.lineTo(x+i,b+a)}s.closePath(),s.stroke()}function be(t,e=!1){We(t),t instanceof Q&&Ue(t,e)}var He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Draw:$,drawAllObjects:ee,drawAllFields:W,drawField:be});const v=[new Z("circle",[100,100],100),new Z("polygon",[0,0],[[0,0],[0,100],[100,100],[100,0]])],se=new Map;function Fe(t){const e=new $e("ball",t.config);return ee(),e}function we(t){return{mass:"\u8D28\u91CF",radius:"\u534A\u5F84",x:"x\u5750\u6807",y:"y\u5750\u6807",vx:"x\u901F\u5EA6",vy:"y\u901F\u5EA6",charge:"\u7535\u8377",electricMagnitudeX:"x\u573A\u5F3A",electricMagnitudeY:"y\u573A\u5F3A",scale:"\u7F29\u653E",shape:"\u5F62\u72B6"}[t]||t}function Se(t,e,s){const n=t.radius,i=(Math.min(e,s)-10)/(n*2);return{radius:n*i}}function ie(t,e,s,n){let i=se.get(t);const a=ne(t,e,s);if(!i){const o={scale:a.scale,center:a.center};n||(se.set(t,o),i=o)}return n?t.node.map(o=>[(o[0]-a.center[0])*a.scale+e/2,(o[1]-a.center[1])*a.scale+s/2]):t.node.map(o=>[(o[0]-i.center[0])*i.scale+e/2,(o[1]-i.center[1])*i.scale+s/2])}function ne(t,e,s){const n=e/s,i=t.node.map(_=>_[1]),a=t.node.map(_=>_[0]),o=Math.min(...a),l=Math.max(...a),r=Math.min(...i),c=Math.max(...i),u=l-o,h=c-r,p=[o+u/2,r+h/2],m=u>h*n?(e-10)/u:(s-10)/h;return{center:p,scale:m}}function Ce(t,e){return ie(v[t],e.width,e.height).map(s=>[s[0]*e.scale+e.dx,s[1]*e.scale+e.dy])}function oe(t){return{circle:"\u5706\u5F62",polygon:"\u591A\u8FB9\u5F62"}[t]||"\u672A\u77E5"}function Ke(t){const e=v[t];return e.type==="circle"?[e.center[0],e.center[1]]:v[t].node.slice()}function ae(t){const e=getComputedStyle(t);t.width=parseInt(e.width),t.height=parseInt(e.height)}async function E(t,e){const s=v[t],i=document.getElementById(e.canvas).getContext("2d"),{dx:a,dy:o,width:l,height:r,scale:c}=e;if(i.clearRect(0,0,l,r),i.strokeStyle=e.strokeStyle||"#222",i.lineWidth=2,i.fillStyle=e.fillStyle||"#6495ED",i.beginPath(),s.type==="circle"){const u=Se(s,l,r);i.arc(l/2*c+a,r/2*c+o,u.radius*c,0,2*Math.PI),i.fill(),i.stroke(),e.node&&(e.hover===0?i.fillStyle="#777":i.fillStyle="black",i.fillRect(l/2*c+a-5,r/2*c+o-5,10,10))}else{const u=ie(s,l,r,e.noCache);i.moveTo(u[0][0]*c+a,u[0][1]*c+o);for(const[h,p]of u)i.lineTo(h*c+a,p*c+o);i.closePath(),i.fill(),i.stroke(),e.node&&u.forEach((h,p)=>{e.hover===p?i.fillStyle="#777":i.fillStyle="black",i.fillRect(h[0]*c+a-5,h[1]*c+o-5,10,10)})}}function Ee(t,e,s,n,i){const a=se.get(t),[o,l]=t.node[e],{scale:r}=i,[c,u]=[o+s/r/a.scale,l+n/r/a.scale];t.type==="circle"||(t.node[e]=[c,u])}function ke(t){new Q("electric",t.config.magnitude,t.config.shape,t.config.position),W()}function O(t,e){let s="m";const n=[1,10,100,500,1e3],a=document.getElementById(e.canvas).getContext("2d"),o=ne(t,e.width,e.height).scale,l=e.width-20,r=e.height-20,c=100/o/e.scale;let u=0,h=100;c>1e4&&(s="km");for(let p=4;p>=0;p--)if(s==="m"){if(c*100/n[p]>50||p===0){h=n[p],u=h*100/c;break}}else if(c*100/n[p]>5e4){h=n[p],u=h*1e5/c;break}a.strokeStyle="#222",a.beginPath(),a.moveTo(l,r-10),a.lineTo(l,r),a.lineTo(l-u,r),a.lineTo(l-u,r-10),a.stroke(),a.textAlign="center",a.textBaseline="middle",a.fillStyle="#222",a.font="16px 20 Arial",a.fillText(`${h}${s}`,l-u/2,r-10),console.log(h)}var Qe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shapeList:v,addRoundObject:Fe,getName:we,centerCircle:Se,centerPolygon:ie,getScale:ne,getComputedNode:Ce,getShapeTypeName:oe,generateNode:Ke,initCanvas:ae,drawShape:E,changeNode:Ee,addElectricField:ke,drawScale:O});var M=(t,e)=>{const s=t.__vccOpts||t;for(const[n,i]of e)s[n]=i;return s};let re={};const Ze=A({name:"ObjectsVue",emits:["choose"],props:{obj:{type:Object,required:!0},index:{required:!0}},data(){return{detail:!1,objectList:U,getName:we,shapeList:v,configs:{x:"0",y:"0",vx:"0",vy:"0",mass:"1",radius:"50",charge:"0",shape:"1",electricMagnitudeX:"100",electricMagnitudeY:"100",scale:"1"},shape:re}},methods:{createConfig(t,e){const s={};for(const n in t){const i=parseFloat(t[n]);isNaN(i)?s[n]=t[n]:s[n]=i}return s.position=[s.x,s.y],s.velocity=[s.vx,s.vy],e==="electricField"&&(s.magnitude=[parseFloat(s.electricMagnitudeX),parseFloat(s.electricMagnitudeY)]),s.shape=v[parseInt(s.shape)],{type:e,config:s}},create(t,e){const s=this.createConfig(t,e);switch(e){case"ball":return Fe(s);case"electricField":return ke(s)}},triggerDetail(){this.detail=!this.detail,requestAnimationFrame(()=>{const t=document.getElementById("select-canvas");!t||E(parseInt(this.configs.shape),{dx:0,dy:0,canvas:"select-canvas",scale:1,width:t.width,height:t.height,strokeStyle:"#ddd",noCache:!0})})}},mounted(){const t=JSON.parse(JSON.stringify(this.shape)),e={get:(s,n)=>n in s?s[n]:0,set:(s,n,i)=>{if(n!==this.index)return!0;s[n]=i,this.configs.shape=i.toString();const a=document.getElementById("select-canvas");return E(parseInt(this.configs.shape),{dx:0,dy:0,canvas:"select-canvas",scale:1,width:a.width,height:a.height,strokeStyle:"#ddd",noCache:!0}),!0}};re=this.shape=new Proxy(t,e)}}),et=t=>(B("data-v-12e7ab8e"),t=t(),L(),t),tt={id:"brief"},st=["src"],it={class:"text"},nt={key:0},ot={class:"detail"},at={class:"input-prompt"},rt={key:0,id:"input-box"},ct=["onUpdate:modelValue"],lt={id:"unit"},dt={key:1,id:"select-box"},ht=et(()=>d("canvas",{id:"select-canvas"},null,-1));function ut(t,e,s,n,i,a){return f(),g(C,null,[d("div",tt,[d("button",{id:"detail",onClick:e[0]||(e[0]=o=>t.triggerDetail())},F(t.detail?"\u7B80\u7565":"\u8BE6\u7EC6"),1),d("img",{id:"image",src:`/source/${t.obj.img}`},null,8,st),d("span",it,F(t.obj.name),1),d("button",{class:"create",onClick:e[1]||(e[1]=o=>t.create(t.configs,t.obj.type))},"\u521B\u5EFA")]),t.detail?(f(),g("hr",nt)):I("",!0),t.detail?(f(!0),g(C,{key:1},N(t.obj.config,o=>(f(),g("div",ot,[d("span",at,F(t.getName(o.split(":")[0])),1),o.split(":")[1]!=="choose"?(f(),g("span",rt,[he(d("input",{class:"input",type:"text","onUpdate:modelValue":l=>t.configs[o.split(":")[0]]=l},null,8,ct),[[ue,t.configs[o.split(":")[0]],void 0,{trim:!0}]]),d("span",lt,F(o.split(":")[1]),1)])):(f(),g("div",dt,[ht,d("button",{onClick:e[2]||(e[2]=l=>t.$emit("choose",t.index)),class:"select-button"},"\u9009\u62E9")]))]))),256)):I("",!0)],64)}var pt=M(Ze,[["render",ut],["__scopeId","data-v-12e7ab8e"]]);const ft=A({name:"ObjectsVue",emits:["choose"],data(){return{objectList:U}},components:{OneObjectVue:pt},methods:{choose(t){this.$emit("choose",t)}}}),gt={class:"object"};function mt(t,e,s,n,i,a){const o=T("one-object-vue");return f(!0),g(C,null,N(t.objectList,(l,r)=>(f(),g("div",gt,[J(o,{onChoose:t.choose,obj:l,index:r},null,8,["onChoose","obj","index"])]))),256)}var yt=M(ft,[["render",mt]]);async function G(t){const e=document.getElementsByClassName("shape-canvas");Array.from(e).forEach(async n=>{ae(n);const i=n.id,a=i.split("-");await E(parseInt(a[3]),{canvas:i,node:!1,dx:0,dy:0,scale:1,strokeStyle:t||"#ccc",width:n.width,height:n.height,noCache:!0})})}const vt=A({emits:["editShape"],name:"Shapes",data:()=>({shapeList:v}),methods:{drawThumbnail:G},async mounted(){await G()}}),_t=t=>(B("data-v-571fe5fe"),t=t(),L(),t),$t={class:"shape"},xt=["id"],bt=["onClick","id"],Ft=_t(()=>d("button",{id:"create"},"\u521B\u5EFA\u65B0\u5F62\u72B6",-1));function wt(t,e,s,n,i,a){return f(),g(C,null,[(f(!0),g(C,null,N(t.shapeList,(o,l)=>(f(),g("div",$t,[d("canvas",{width:"100",height:"50",id:`shape-${o.id}-${o.type}-${l}`,class:"shape-canvas"},null,8,xt),d("button",{onClick:r=>t.$emit("editShape",l),id:`button-${o.id}`,class:"button"},"\u7F16\u8F91",8,bt)]))),256)),Ft],64)}var St=M(vt,[["render",wt],["__scopeId","data-v-571fe5fe"]]);const R=new Map;var Ct="/assets/lessen.7b4a6772.png",Et="/assets/enlarge.d3a5bf03.png";const X={};let V=-1,ce=!1;const kt=A({emits:["confirm","cancel"],name:"ShapeEditor",props:{index:{type:Number,required:!0}},data(){return{shapeList:v,scale:1,dx:0,dy:0,width:0,height:0}},methods:{getShapeTypeName:oe,listenMove(t,e){const s=v[e],n={canvas:"editor-canvas",node:!0,dx:this.dx,dy:this.dy,scale:this.scale,width:this.width,height:this.height};if(ce){if(s.type==="circle")return;Ee(s,V,t.movementX,t.movementY,n),E(e,n),O(v[this.index],n);return}const i=[];s.type==="circle"?i.push([s.center[0]+this.dx,s.center[1]+this.dy]):i.push(...Ce(e,{dx:this.dx,dy:this.dy,scale:this.scale,width:this.width,height:this.height}));const a=i.findIndex(([o,l],r)=>Math.abs(t.offsetX-o)<=10&&Math.abs(t.offsetY-l)<=10);if(n.hover=a,a===-1){V>=0&&(V=-1,E(e,n),O(v[this.index],n));return}V=a,E(e,n),O(v[this.index],n)},triggerScale(t){t==="enlarge"?this.scale*=1.1:this.scale/=1.1},listenDown(t,e){V!==-1&&(ce=!0)},listenUp(t,e){ce=!1},cancel(t){this.$emit("cancel",X,v[t],this.scale)}},async mounted(){const t=document.getElementById("editor-canvas");ae(t),this.width=t.width,this.height=t.height;const e=v[this.index];R.get(e)||R.set(e,1),this.scale=R.get(e)||1;const s={canvas:"editor-canvas",node:!0,dx:0,dy:0,scale:this.scale,width:this.width,height:this.height};await E(this.index,s),O(v[this.index],s),e.type==="circle"?(e.center.slice(),X.radius=e.radius,X.center=e.center.slice()):(e.node.slice(),X.node=e.node.slice())},watch:{scale(t,e){const s=(t-e)*this.width/2,n=(t-e)*this.height/2;this.dx-=s,this.dy-=n,R.set(v[this.index],t),requestAnimationFrame(()=>{const i={canvas:"editor-canvas",node:!0,dx:this.dx,dy:this.dy,scale:this.scale,width:this.width,height:this.height};E(this.index,i),O(v[this.index],i)})}}}),le=t=>(B("data-v-201b48fe"),t=t(),L(),t),At={id:"root"},Mt={id:"back"},jt={id:"description"},It={class:"text"},Bt=le(()=>d("span",{class:"text",id:"center"},"\u56FE\u5F62\u7F16\u8F91\u5668",-1)),Lt={class:"text"},Ot=le(()=>d("hr",{id:"top"},null,-1)),Nt={id:"editor"},Tt=le(()=>d("hr",{id:"bottom"},null,-1)),Pt={id:"tools"},Rt=Be('<div id="leftTool" data-v-201b48fe><button class="tool" data-v-201b48fe>\u64A4\u9500</button><button class="tool" data-v-201b48fe>\u91CD\u505A</button></div><div id="middleTool" data-v-201b48fe><button class="tool" id="detail" data-v-201b48fe>\u8BE6\u7EC6\u4FE1\u606F</button></div>',2),Vt={id:"rightTool"};function Dt(t,e,s,n,i,a){return f(),g("div",At,[d("div",Mt,[d("div",jt,[d("span",It,"\u56FE\u5F62id\uFF1A"+F(t.shapeList[t.index].id),1),Bt,d("span",Lt,"\u56FE\u5F62\u7C7B\u578B\uFF1A"+F(t.getShapeTypeName(t.shapeList[t.index].type)),1)]),Ot,d("div",Nt,[d("img",{class:"scale",onClick:e[0]||(e[0]=o=>t.triggerScale("lessen")),id:"lessen",src:Ct}),d("img",{class:"scale",onClick:e[1]||(e[1]=o=>t.triggerScale("enlarge")),id:"enlarge",src:Et}),d("canvas",{onMouseup:e[2]||(e[2]=o=>t.listenUp(o,t.index)),onMousedown:e[3]||(e[3]=o=>t.listenDown(o,t.index)),onMousemove:e[4]||(e[4]=o=>t.listenMove(o,t.index)),id:"editor-canvas"},null,32)]),Tt,d("div",Pt,[Rt,d("div",Vt,[d("button",{class:"tool",onClick:e[5]||(e[5]=o=>t.cancel(t.index))},"\u53D6\u6D88"),d("button",{class:"tool",onClick:e[6]||(e[6]=o=>t.$emit("confirm"))},"\u786E\u5B9A")])])])])}var qt=M(kt,[["render",Dt],["__scopeId","data-v-201b48fe"]]);const zt=A({name:"ShapeSelector",emits:["select","cancel"],props:{index:String},data(){return{shapeList:v,getShapeTypeName:oe}},async mounted(){await G("#222")}}),de=t=>(B("data-v-a7b48c00"),t=t(),L(),t),Yt={id:"root"},Wt={id:"back"},Gt=de(()=>d("div",{id:"select"},"\u9009\u62E9\u56FE\u5F62",-1)),Xt=de(()=>d("hr",null,null,-1)),Jt={id:"shapes"},Ut={class:"shape"},Ht=["id"],Kt={class:"shape-text"},Qt={class:"shape-text"},Zt=["onClick"],es=de(()=>d("hr",null,null,-1)),ts={id:"tools"};function ss(t,e,s,n,i,a){return f(),g("div",Yt,[d("div",Wt,[Gt,Xt,d("div",Jt,[(f(!0),g(C,null,N(t.shapeList,(o,l)=>(f(),g("div",Ut,[d("canvas",{class:"shape-canvas",id:`shape-${o.id}-${o.type}-${l}`},null,8,Ht),d("span",Kt,"\u56FE\u5F62id\uFF1A"+F(o.id),1),d("span",Qt,"\u56FE\u5F62\u7C7B\u578B\uFF1A"+F(t.getShapeTypeName(o.type)),1),d("button",{class:"shape-select",onClick:r=>t.$emit("select",l,t.index)},"\u9009\u62E9",8,Zt)]))),256))]),es,d("div",ts,[d("button",{class:"tool",onClick:e[0]||(e[0]=o=>t.$emit("cancel"))},"\u53D6\u6D88"),d("button",{class:"tool",onClick:e[1]||(e[1]=o=>t.$emit("cancel"))},"\u786E\u5B9A")])])])}var is=M(zt,[["render",ss],["__scopeId","data-v-a7b48c00"]]);const ns=Object.values(U),os=[{id:"objects",text:"\u7269\u4F53"},{id:"shapes",text:"\u5F62\u72B6"}];function as(t){t.id==="fold"||t.id==="list"?t.style.right="300px":t.style.right="0px"}const rs=A({name:"RightBar",data:()=>({objectList:ns,shapeList:v,selectList:os,folded:!1,selected:"objects-vue",editing:!1,editIndex:0,selecting:!1,beSelectedIndex:"electricField"}),provide(){return{shapeSelect:0}},methods:{triggerFold(){const t=document.getElementsByClassName("bar");Array.from(t).forEach(n=>{let i=parseFloat(n.style.right);isNaN(i)&&(as(n),i=parseFloat(n.style.right)),this.folded?n.style.right=n.id==="list"?`${i+380}px`:`${i+300}px`:n.style.right=n.id==="list"?`${i-380}px`:`${i-300}px`});const s=document.getElementById("fold-text");s.style.transform=this.folded?"rotateY(0deg)":"rotateY(180deg)",this.folded=!this.folded},select(t){this.selected=`${t}-vue`},editShape(t){this.editIndex=t,this.editing=!0},async confirmEdit(){this.editing=!1,await G(),W(!0)},cancelEdit(t,e,s){this.editing=!1,e.type==="circle"&&t.radius&&t.center?(e.radius=t.radius,e.center=t.center.slice()):t.node&&(e.node=t.node),R.set(e,s)},selectShape(t,e){re[e]=t},openSelectShape(t){this.beSelectedIndex=t,requestAnimationFrame(()=>{this.selecting=!0})}},components:{ObjectsVue:yt,ShapesVue:St,ShapeEditorVue:qt,ShapeSelectorVue:is}}),cs=t=>(B("data-v-33b56482"),t=t(),L(),t),ls={id:"right-bar",class:"bar"},ds=cs(()=>d("div",{id:"fold-text"},"\u25B6",-1)),hs=[ds],us={id:"list",class:"bar"},ps=["onClick","status"];function fs(t,e,s,n,i,a){const o=T("ShapeEditorVue"),l=T("ShapeSelectorVue");return f(),g(C,null,[d("div",ls,[(f(),D(Oe,null,[(f(),D(Le(t.selected),{onEditShape:t.editShape,onChoose:t.openSelectShape},null,8,["onEditShape","onChoose"]))],1024))]),d("div",{id:"fold",class:"bar",onClick:e[0]||(e[0]=r=>t.triggerFold())},hs),d("div",us,[(f(!0),g(C,null,N(t.selectList,r=>(f(),g("div",{onClick:c=>t.select(r.id),class:"select",status:t.selected===`${r.id}-vue`},F(r.text),9,ps))),256))]),t.editing?(f(),D(o,{key:0,onConfirm:t.confirmEdit,onCancel:t.cancelEdit,index:t.editIndex},null,8,["onConfirm","onCancel","index"])):I("",!0),t.selecting?(f(),D(l,{key:1,onCancel:e[1]||(e[1]=r=>t.selecting=!1),onSelect:t.selectShape,index:t.beSelectedIndex},null,8,["onSelect","index"])):I("",!0)],64)}var gs=M(rs,[["render",fs],["__scopeId","data-v-33b56482"]]),ms="/assets/settings.0c9bdc27.png",ys="/assets/play.0bc8270f.png",vs="/assets/pause.429c644f.png",_s="/assets/speeddown.1f507ff4.png",$s="/assets/speedup.58720e73.png";const xs=A({name:"LeftBar",data:()=>({app:Y,folded:!1,status:"running"}),methods:{triggerPlaying(){const t=this.app.status;t==="running"?Y.pause():t==="paused"&&Y.resume(),this.status=this.app.status},triggerFold(){const t=document.getElementById("settings"),e=/rotate\([0-9]+deg\)/.exec(t.style.transform)||[],s=parseInt((/[0-9]+/.exec(e[0])||[])[0]||"0");t.style.transform=`rotate(${s+90}deg)`;const n=document.getElementById("left-bar"),i=document.getElementById("hr");this.folded?(n.style.width="375px",i.style.display="block"):(n.style.width="48px",setTimeout(()=>{i.style.display="none"},500)),this.folded=!this.folded},changeSpeed(t){const e=this.app.speed;t==="up"?e<10&&(this.app.speed=parseFloat((e+.1).toFixed(1))):e>.1&&(this.app.speed=parseFloat((e-.1).toFixed(1)))}}}),Ae=t=>(B("data-v-68f08884"),t=t(),L(),t),bs={id:"left-bar",style:{"z-index":"200"}},Fs=Ae(()=>d("span",{id:"hr"},null,-1)),ws=Ae(()=>d("span",{id:"hr"},null,-1)),Ss={id:"speed",style:{"padding-left":"2px"}};function Cs(t,e,s,n,i,a){return f(),g("div",bs,[d("img",{onClick:e[0]||(e[0]=o=>t.triggerFold()),id:"settings",class:"settings",src:ms,style:{width:"48px",height:"48px"}}),Fs,t.status==="paused"?(f(),g("img",{key:0,onClick:e[1]||(e[1]=o=>t.triggerPlaying()),class:"settings",id:"play",src:ys,style:{width:"40px","margin-right":"6px"}})):I("",!0),t.status==="running"?(f(),g("img",{key:1,onClick:e[2]||(e[2]=o=>t.triggerPlaying()),class:"settings",id:"pause",src:vs,style:{width:"40px","margin-right":"6px"}})):I("",!0),d("img",{class:"settings",onClick:e[3]||(e[3]=o=>t.changeSpeed("down")),id:"speeddown",src:_s,style:{width:"40px","margin-right":"6px"}}),he(d("input",{type:"range",max:"10",min:"0.1",step:"0.1","onUpdate:modelValue":e[4]||(e[4]=o=>t.app.speed=o)},null,512),[[ue,t.app.speed]]),d("img",{class:"settings",onClick:e[5]||(e[5]=o=>t.changeSpeed("up")),id:"speedup",src:$s,style:{width:"40px","margin-right":"6px"}}),ws,d("span",Ss,"\xD7"+F(t.app.speed),1)])}var Es=M(xs,[["render",Cs],["__scopeId","data-v-68f08884"]]);const ks=A({name:"App",data(){return{rightToolbar:!0}},components:{RightBar:gs,LeftBar:Es}}),As=d("canvas",{id:"objects"},null,-1),Ms=d("canvas",{id:"fields"},null,-1);function js(t,e,s,n,i,a){const o=T("RightBar"),l=T("LeftBar");return f(),g(C,null,[As,Ms,J(o),J(l)],64)}var Is=M(ks,[["render",js]]);Ne(Is).mount("#app");fe(()=>Promise.resolve().then(function(){return He}),void 0).then(t=>new t.Draw);
